import cv2
import numpy as np
import matplotlib.pyplot as plt
[[28.2187619, 112.9278209], [28.2187712, 112.9266732], [28.2187712, 112.9266732], [28.2179072, 112.9282175], [28.2129305, 112.9282831], [28.2139166, 112.9240188], [28.2177173, 112.9281684], [28.2183705, 112.9283298], [28.2254419, 112.9317855], [28.2254419, 112.9317855], [28.2223028, 112.9343641], [28.2183705, 112.9283298], [28.224865, 112.918458], [28.225838, 112.916924], [28.2253282, 112.9221297], [28.229292, 112.912896], [28.2250475, 112.9172361], [28.2253936, 112.9170928], [28.2248364, 112.9094561], [28.2287, 112.905057], [28.2248234, 112.9073953], [28.2247914, 112.9044607], [28.2247914, 112.9044607], [28.2249889, 112.8983027], [28.2255094, 112.8913205], [28.229294, 112.882996], [28.2261518, 112.8806776], [28.231684, 112.8634199], [28.2369491, 112.8437907], [28.242061, 112.812698], [28.242465, 112.810694], [28.2408105, 112.8092323], [28.2444, 112.7888577], [28.247787, 112.775328], [28.2439871, 112.7653939], [28.2584502, 112.7249373], [28.2581128, 112.7219103], [28.2719238, 112.6923934], [28.2780743, 112.6686138], [28.2780745, 112.6627425], [28.264059, 112.6573372], [28.2662077, 112.638623], [28.2673649, 112.628759], [28.2695014, 112.6099639], [28.275293, 112.600446], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2829937, 112.5990801], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2778448, 112.6006231], [28.2815129, 112.5977357], [28.2778448, 112.6006231], [28.2815129, 112.5977357], [28.2754956, 112.602347], [28.2754956, 112.602347], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2856798, 112.5972854], [28.2829937, 112.5990801], [28.2829937, 112.5990801], [28.2815129, 112.5977357], [28.2778448, 112.6006231], [28.2815129, 112.5977357], [28.2829937, 112.5990801], [28.2815129, 112.5977357], [28.2778448, 112.6006231], [28.2754907, 112.6034513], [28.2732558, 112.6051034], [28.2732558, 112.6051034], [28.2732558, 112.6051034], [28.2691328, 112.6242456], [28.2691328, 112.6242456], [28.2691328, 112.6242456], [28.2760669, 112.6320285], [28.2760669, 112.6320285], [28.2691328, 112.6242456], [28.2760669, 112.6320285], [28.2760669, 112.6320285], [28.2760669, 112.6320285], [28.2760669, 112.6320285], [28.2760669, 112.6320285], [28.2760669, 112.6320285], [28.279112, 112.608525], [28.2691328, 112.6242456], [28.2760669, 112.6320285], [28.2691328, 112.6242456], [28.2691328, 112.6242456], [28.27905, 112.608037], [28.27905, 112.608037], [28.2760669, 112.6320285], [28.2760669, 112.6320285], [28.2691328, 112.6242456], [28.2751069, 112.6060628], [28.2691328, 112.6242456], [28.2732558, 112.6051034], [28.2805637, 112.5977205], [28.2815129, 112.5977357], [28.2732558, 112.6051034], [28.2732558, 112.6051034], [28.2691328, 112.6242456], [28.2671956, 112.6302113], [28.2660465, 112.6386369], [28.2645334, 112.6498779], [28.2634988, 112.6591105], [28.2721257, 112.659933], [28.2786282, 112.6649105], [28.2719238, 112.6923934], [28.2581128, 112.7219103], [28.2584502, 112.7249373], [28.2439871, 112.7653939], [28.2444, 112.7888577], [28.2408105, 112.8092323], [28.2408105, 112.8092323], [28.2369491, 112.8437907], [28.2346389, 112.8516268], [28.2292301, 112.8712687], [28.2254015, 112.8930116], [28.224888, 112.9018793], [28.2254015, 112.8930116], [28.2252208, 112.89271], [28.2127637, 112.8909975], [28.2101991, 112.8892163], [28.2092339, 112.8827083], [28.2054758, 112.881572], [28.2092339, 112.8827083], [28.2045511, 112.8823383], [28.2045511, 112.8823383], [28.2045511, 112.8823383], [28.2054758, 112.881572], [28.2054758, 112.881572], [28.2045511, 112.8823383], [28.2045511, 112.8823383], [28.2086225, 112.8839646], [28.2086225, 112.8839646], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2184163, 112.8757368], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501]]

pos = np.array([[28.2187619, 112.9278209], [28.2187712, 112.9266732], [28.2187712, 112.9266732], [28.2179072, 112.9282175], [28.2129305, 112.9282831], [28.2139166, 112.9240188], [28.2177173, 112.9281684], [28.2183705, 112.9283298], [28.2254419, 112.9317855], [28.2254419, 112.9317855], [28.2223028, 112.9343641], [28.2183705, 112.9283298], [28.224865, 112.918458], [28.225838, 112.916924], [28.2253282, 112.9221297], [28.229292, 112.912896], [28.2250475, 112.9172361], [28.2253936, 112.9170928], [28.2248364, 112.9094561], [28.2287, 112.905057], [28.2248234, 112.9073953], [28.2247914, 112.9044607], [28.2247914, 112.9044607], [28.2249889, 112.8983027], [28.2255094, 112.8913205], [28.229294, 112.882996], [28.2261518, 112.8806776], [28.231684, 112.8634199], [28.2369491, 112.8437907], [28.242061, 112.812698], [28.242465, 112.810694], [28.2408105, 112.8092323], [28.2444, 112.7888577], [28.247787, 112.775328], [28.2439871, 112.7653939], [28.2584502, 112.7249373], [28.2581128, 112.7219103], [28.2719238, 112.6923934], [28.2780743, 112.6686138], [28.2780745, 112.6627425], [28.264059, 112.6573372], [28.2662077, 112.638623], [28.2673649, 112.628759], [28.2695014, 112.6099639], [28.275293, 112.600446], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2829937, 112.5990801], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2778448, 112.6006231], [28.2815129, 112.5977357], [28.2778448, 112.6006231], [28.2815129, 112.5977357], [28.2754956, 112.602347], [28.2754956, 112.602347], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2815129, 112.5977357], [28.2856798, 112.5972854], [28.2829937, 112.5990801], [28.2829937, 112.5990801], [28.2815129, 112.5977357], [28.2778448, 112.6006231], [28.2815129, 112.5977357], [28.2829937, 112.5990801], [28.2815129, 112.5977357], [28.2778448, 112.6006231], [28.2754907, 112.6034513], [28.2732558, 112.6051034], [28.2732558, 112.6051034], [28.2732558, 112.6051034], [28.2691328, 112.6242456], [28.2691328, 112.6242456], [28.2691328, 112.6242456], [28.2760669, 112.6320285], [28.2760669, 112.6320285], [28.2691328, 112.6242456], [28.2760669, 112.6320285], [28.2760669, 112.6320285], [28.2760669, 112.6320285], [28.2760669, 112.6320285], [28.2760669, 112.6320285], [28.2760669, 112.6320285], [28.279112, 112.608525], [28.2691328, 112.6242456], [28.2760669, 112.6320285], [28.2691328, 112.6242456], [28.2691328, 112.6242456], [28.27905, 112.608037], [28.27905, 112.608037], [28.2760669, 112.6320285], [28.2760669, 112.6320285], [28.2691328, 112.6242456], [28.2751069, 112.6060628], [28.2691328, 112.6242456], [28.2732558, 112.6051034], [28.2805637, 112.5977205], [28.2815129, 112.5977357], [28.2732558, 112.6051034], [28.2732558, 112.6051034], [28.2691328, 112.6242456], [28.2671956, 112.6302113], [28.2660465, 112.6386369], [28.2645334, 112.6498779], [28.2634988, 112.6591105], [28.2721257, 112.659933], [28.2786282, 112.6649105], [28.2719238, 112.6923934], [28.2581128, 112.7219103], [28.2584502, 112.7249373], [28.2439871, 112.7653939], [28.2444, 112.7888577], [28.2408105, 112.8092323], [28.2408105, 112.8092323], [28.2369491, 112.8437907], [28.2346389, 112.8516268], [28.2292301, 112.8712687], [28.2254015, 112.8930116], [28.224888, 112.9018793], [28.2254015, 112.8930116], [28.2252208, 112.89271], [28.2127637, 112.8909975], [28.2101991, 112.8892163], [28.2092339, 112.8827083], [28.2054758, 112.881572], [28.2092339, 112.8827083], [28.2045511, 112.8823383], [28.2045511, 112.8823383], [28.2045511, 112.8823383], [28.2054758, 112.881572], [28.2054758, 112.881572], [28.2045511, 112.8823383], [28.2045511, 112.8823383], [28.2086225, 112.8839646], [28.2086225, 112.8839646], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2184163, 112.8757368], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501], [28.2137354, 112.8732501]]
, np.float32)

'''
它有3个输入参数，dynam_params：状态空间的维数，这里为2；measure_param：测量值的维数，这里也为2; control_params：控制向量的维数，默认为0。由于这里该模型中并没有控制变量，因此也为0。
'''
kalman = cv2.KalmanFilter(2, 2)

kalman.measurementMatrix = np.array([[1, 0], [0, 1]], np.float32)
kalman.transitionMatrix = np.array([[1, 0], [0, 1]], np.float32)
kalman.processNoiseCov = np.array([[1, 0], [0, 1]], np.float32) * 1e-3
kalman.measurementNoiseCov = np.array([[1, 0], [0, 1]], np.float32) * 0.01
'''
kalman.measurementNoiseCov为测量系统的协方差矩阵，方差越小，预测结果越接近测量值，kalman.processNoiseCov为模型系统的噪声，噪声越大，预测结果越不稳定，越容易接近模型系统预测值，且单步变化越大，相反，若噪声小，则预测结果与上个计算结果相差不大。
'''

kalman.statePre = np.array([[6], [6]], np.float32)

for i in range(len(pos)):
    mes = np.reshape(pos[i, :], (2, 1))
    x = kalman.correct(mes)
    y = kalman.predict()
    # print(kalman.statePost[0], kalman.statePost[1])
    # print(kalman.statePre[0], kalman.statePre[1])
    print('measurement:\t', mes[0], mes[1])
    print('correct:\t', x[0], x[1])
    print('predict:\t', y[0], y[1])
    print('=' * 30)
