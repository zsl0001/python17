import pymongo
import pandas as pd

conn = pymongo.MongoClient('192.168.1.168', 27017, username='wangcan', password='123456')
db = conn.er
collection1 = db['position']
# collection2 = db['status']
# data1 = pd.DataFrame(list(collection1.find()))
# data2 = pd.DataFrame(list(collection2.find()))
# print(data2)


m = ['351608087084708', '351608087065392', '351608087064395', '351608087065434', '351608087065053', '351608087064338',
     '351608087085846', '351608087065046', '351608087065400', '351608087065111', '351608087071911', '351608087086018',
     '351608087064312', '351608087058751', '351608087065418', '351608087084732', '351608087084443', '351608087084468',
     '351608087084484', '351608087084450', '351608087084435', '351608087084781', '351608087085994', '351608087060120',
     '351608087085929', '351608087062373', '351608087085903', '351608087061318', '351608087086091', '351608087070020',
     '351608087085978', '351608087065558', '351608087065731', '351608087065582', '351608087065533', '351608087065749',
     '351608087065574', '351608087070210', '351608087070194', '351608087064973', '351608087085879', '351608087070327',
     '351608087086059', '351608087060906', '351608087086067', '351608087059171', '351608086050825', '351608087065095',
     '351608087061508', '351608086051153', '351608087086083', '351608087085911', '351608087068131', '351608087085895',
     '351608087060682', '351608087059320', '351608087077694', '351608087062589', '351608087062399', '351608087061284',
     '351608087085986', '351608087073453', '351608087061730', '351608087076498', '351608087059023', '351608087084740',
     '351608086050734', '351608086050510', '351608086050809', '351608086050940', '351608086051161', '351608086051120',
     '351608086051187', '351608086050882', '351608086050551', '351608086050866', '351608086050569', '351608086050593',
     '351608086050767', '351608086050452', '351608086051005', '351608086050775', '351608086051179', '351608086050536',
     '351608086050874', '351608086050411', '351608086050577', '351608086051021', '351608086051013', '351608086050858',
     '351608086051195', '351608086051203', '351608087058199', '351608087058215', '351608087070640', '351608087080359',
     '351608087080326', '351608087059940', '351608087084773', '351608087064908', '351608087063850', '351608087064189',
     '351608087062852', '351608087075367', '351608087083940', '351608087083957', '351608087061888', '351608087061052',
     '351608087061987', '351608087060419', '351608087060765', '351608087062688', '351608087062787', '351608087060328',
     '351608087062357', '351608087062183', '351608087062670', '351608087060401', '351608087084757', '351608087084799',
     '351608087084419', '351608087084401', '351608087084427', '351608087079971', '351608087079963', '351608087079955',
     '351608087079948', '351608087079997']

c = db.position.aggregate([{'$sort':{'time':-1}},{'$group': {'_id':"$devId","time": {'$first': "$time"}, "lng": {'$first': "$bLongitude"},"lat": {'$first': "$bLatitude"},"model": {'$first': "$model"},"speed": {'$first': "$speed"}}}])
for i in c:
    print(i)